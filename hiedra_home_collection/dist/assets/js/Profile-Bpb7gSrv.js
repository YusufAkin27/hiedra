import{u as e,r as a,j as l}from"./react-vendor-DfawjiNX.js";import{a as s}from"./context-BBxaqZSG.js";import{S as i}from"./SEO-COBDhSYn.js";import"./vendor-invariant-GfE-dftQ.js";import"./vendor-shallowequal-DDPVF0Lr.js";import"./vendor-scheduler-BVKd3TJG.js";import"./vendor-@remix-run-BfCtOoOM.js";const r="http://localhost:8080/api",t=()=>{const{user:t,accessToken:n,isAuthenticated:o}=s(),c=e(),[d,h]=a.useState(!0),[m,p]=a.useState(!1),[u,f]=a.useState(null),[j,x]=a.useState(""),[v,N]=a.useState(""),[y,g]=a.useState({fullName:"",phone:""});a.useEffect(()=>{o||c("/")},[o,c]),a.useEffect(()=>{o&&n&&b()},[o,n]);const b=async()=>{try{h(!0);const e=await fetch(r+"/user/profile",{headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});if(!e.ok)throw Error("Profil bilgileri yüklenemedi");const a=await e.json();a.success&&a.data&&(f(a.data),g({fullName:a.data.fullName||"",phone:a.data.phone||""}))}catch(e){x("Profil bilgileri yüklenemedi")}finally{h(!1)}};return o?d?l.jsxs("div",{className:"profile-container",children:[l.jsx(i,{title:"Profil - Hiedra",description:"Kullanıcı profil sayfası"}),l.jsx("div",{className:"loading",children:"Yükleniyor..."})]}):l.jsxs("div",{className:"profile-container",children:[l.jsx(i,{title:"Profil - Hiedra",description:"Kullanıcı profil sayfası"}),l.jsxs("div",{className:"profile-header",children:[l.jsx("h1",{children:"Profilim"}),l.jsx("p",{children:"Hesap bilgilerinizi güncelleyin"})]}),j&&l.jsx("div",{className:"alert alert-error",children:j}),v&&l.jsx("div",{className:"alert alert-success",children:v}),l.jsx("div",{className:"profile-content",children:l.jsxs("div",{className:"profile-info-card",children:[l.jsxs("div",{className:"profile-avatar-section",children:[l.jsx("div",{className:"profile-avatar",children:u?.fullName?l.jsx("span",{className:"avatar-initials",children:u.fullName.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2)}):l.jsx("span",{className:"avatar-initials",children:u?.email?.[0]?.toUpperCase()||"U"})}),l.jsxs("div",{className:"profile-avatar-info",children:[l.jsx("h2",{children:u?.fullName||"Kullanıcı"}),l.jsx("p",{className:"profile-email",children:u?.email||""})]})]}),l.jsxs("form",{onSubmit:async e=>{e.preventDefault(),p(!0),x(""),N("");try{const e=await fetch(r+"/user/profile",{method:"PUT",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"},body:JSON.stringify(y)}),a=await e.json();e.ok&&a.success?(f(a.data),N("Profil bilgileri güncellendi"),setTimeout(()=>N(""),3e3)):x(a.message||"Profil güncellenemedi")}catch(a){x("Profil güncellenirken bir hata oluştu")}finally{p(!1)}},className:"profile-form",children:[l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{htmlFor:"email",children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),l.jsx("polyline",{points:"22,6 12,13 2,6"})]}),"E-posta"]}),l.jsx("input",{type:"email",id:"email",value:u?.email||"",disabled:!0,className:"disabled-input"}),l.jsx("small",{children:"E-posta adresi değiştirilemez"})]}),l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{htmlFor:"fullName",children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Ad Soyad *"]}),l.jsx("input",{type:"text",id:"fullName",value:y.fullName,onChange:e=>g({...y,fullName:e.target.value}),placeholder:"Adınız ve soyadınız",required:!0})]}),l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{htmlFor:"phone",children:[l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),"Telefon Numarası *"]}),l.jsx("input",{type:"tel",id:"phone",value:y.phone,onChange:e=>g({...y,phone:e.target.value}),placeholder:"05XX XXX XX XX",required:!0})]}),l.jsxs("div",{className:"form-actions",children:[l.jsx("button",{type:"submit",className:"btn-primary",disabled:m,children:m?"Kaydediliyor...":"Bilgileri Güncelle"}),l.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>c("/"),children:"Ana Sayfaya Dön"})]})]})]})})]}):null};export{t as default};

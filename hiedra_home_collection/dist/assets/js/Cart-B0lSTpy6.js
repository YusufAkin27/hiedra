import{u as e,r as s,j as i,L as t}from"./react-vendor-DfawjiNX.js";import{u as a,a as c}from"./context-BBxaqZSG.js";import"./vendor-invariant-GfE-dftQ.js";import"./vendor-shallowequal-DDPVF0Lr.js";import"./vendor-scheduler-BVKd3TJG.js";import"./vendor-@remix-run-BfCtOoOM.js";const n="http://localhost:8080/api",r=()=>{const{cartItems:r,removeFromCart:l,updateQuantity:o,clearCart:d,getCartTotal:m,refreshCart:h}=a(),{accessToken:j,isAuthenticated:u}=c(),x=e();s.useEffect(()=>{h()},[]);const p=async(e,s=null,i=null)=>{try{if(i&&s&&s.startsWith("backend_")){let e=null;u&&j||(e=localStorage.getItem("guestUserId"));const s=`${n}/cart/items/${i}${e?"?guestUserId="+e:""}`;if((await fetch(s,{method:"DELETE",headers:{"Content-Type":"application/json",...j&&{Authorization:"Bearer "+j}}})).ok)return void(await h())}l(e,s)}catch(t){l(e,s)}},v=async(e,s,i=null,t=null)=>{if(s>0)try{if(t&&i&&i.startsWith("backend_")){let e=null;u&&j||(e=localStorage.getItem("guestUserId"));const i=`${n}/cart/items/${t}${e?"?guestUserId="+e:""}`;if((await fetch(i,{method:"PUT",headers:{"Content-Type":"application/json",...j&&{Authorization:"Bearer "+j}},body:JSON.stringify({quantity:s})})).ok)return void(await h())}o(e,s,i)}catch(a){o(e,s,i)}else p(e,i,t)};return 0===r.length?i.jsx("div",{className:"cart-container",children:i.jsxs("div",{className:"empty-cart",children:[i.jsx("h2",{children:"Sepetiniz boş"}),i.jsx("p",{children:"Alışverişe başlamak için ürünlerimizi inceleyin"}),i.jsx(t,{to:"/",className:"shop-btn",children:"Alışverişe Başla"})]})}):i.jsxs("div",{className:"cart-container",children:[i.jsxs("div",{className:"cart-header",children:[i.jsx("h2",{children:"Sepetim"}),i.jsx("button",{className:"clear-cart-btn",onClick:d,children:"Sepeti Temizle"})]}),i.jsxs("div",{className:"cart-content",children:[i.jsx("div",{className:"cart-items",children:r.map((e,s)=>i.jsxs("div",{className:"cart-item",children:[i.jsx(t,{to:"/product/"+e.id,className:"cart-item-image",children:i.jsx("img",{src:e.image,alt:e.name})}),i.jsxs("div",{className:"cart-item-info",children:[i.jsx(t,{to:"/product/"+e.id,className:"cart-item-name",children:e.name}),i.jsx("span",{className:"cart-item-category",children:e.category}),e.customizations&&i.jsxs("div",{className:"cart-item-customizations",children:[i.jsxs("div",{className:"customization-item",children:[i.jsx("span",{children:"En:"}),i.jsxs("span",{children:[e.customizations.en," cm"]})]}),i.jsxs("div",{className:"customization-item",children:[i.jsx("span",{children:"Boy:"}),i.jsxs("span",{children:[e.customizations.boy," cm"]})]}),i.jsxs("div",{className:"customization-item",children:[i.jsx("span",{children:"Pile:"}),i.jsx("span",{children:"pilesiz"===e.customizations.pileSikligi?"Pilesiz":e.customizations.pileSikligi})]})]})]}),i.jsxs("div",{className:"cart-item-controls",children:[i.jsxs("div",{className:"cart-quantity",children:[i.jsx("button",{onClick:()=>v(e.id,e.quantity-1,e.itemKey,e.cartItemId),children:"-"}),i.jsx("span",{children:e.quantity}),i.jsx("button",{onClick:()=>v(e.id,e.quantity+1,e.itemKey,e.cartItemId),children:"+"})]}),i.jsxs("div",{className:"cart-item-price",children:[((e.customizations?.calculatedPrice||e.price)*e.quantity).toFixed(2)," ₺"]}),i.jsx("button",{className:"remove-item-btn",onClick:()=>p(e.id,e.itemKey,e.cartItemId),children:"✕"})]})]},e.itemKey||`${e.id}_${s}`))}),i.jsxs("div",{className:"cart-summary",children:[i.jsx("h3",{children:"Sipariş Özeti"}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Ara Toplam:"}),i.jsxs("span",{children:[m().toFixed(2)," ₺"]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Kargo:"}),i.jsx("span",{className:"free-shipping",children:"Ücretsiz"})]}),i.jsxs("div",{className:"summary-row total",children:[i.jsx("span",{children:"Toplam:"}),i.jsxs("span",{children:[m().toFixed(2)," ₺"]})]}),i.jsx("button",{className:"checkout-btn",onClick:()=>x("/checkout"),children:"Ödemeye Geç"}),i.jsx(t,{to:"/",className:"continue-shopping",children:"Alışverişe Devam Et"})]})]})]})};export{r as default};

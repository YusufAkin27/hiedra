import{u as e,r as s,j as i}from"./react-vendor-DfawjiNX.js";import{u as a,a as r}from"./context-BBxaqZSG.js";import{u as t}from"./index-CWeyrpi3.js";import{S as n}from"./SEO-COBDhSYn.js";import"./vendor-invariant-GfE-dftQ.js";import"./vendor-shallowequal-DDPVF0Lr.js";import"./vendor-scheduler-BVKd3TJG.js";import"./vendor-@remix-run-BfCtOoOM.js";const l="http://localhost:8080/api",d=()=>{const d=e(),{cartItems:c,getCartTotal:o,clearCart:m}=a(),{user:h,accessToken:p,isAuthenticated:u}=r(),x=t(),[g,j]=s.useState(1),[y,f]=s.useState(!1),[v,N]=s.useState([]),[b,z]=s.useState(null),[k,S]=s.useState(!1),[C,w]=s.useState(!1),[D,q]=s.useState({firstName:"",lastName:"",email:"",phone:""}),[I,M]=s.useState({address:"",city:"",district:"",addressDetail:""}),[A,P]=s.useState({cardNumber:"",cardName:"",expiryMonth:"",expiryYear:"",cvv:""});s.useEffect(()=>{if(u&&h&&(!D.firstName&&!D.lastName&&!D.phone||D.email===h.email)){let e="",s="";if(h.fullName){const i=h.fullName.trim().split(/\s+/);e=i[0]||"",s=i.slice(1).join(" ")||""}q(i=>({firstName:i.firstName||e,lastName:i.lastName||s,email:i.email||h.email||"",phone:i.phone||h.phone||""}))}},[u,h]),s.useEffect(()=>{u&&p&&(2===g||1===g)&&B()},[u,p,g]);const B=async()=>{try{w(!0);const e=await fetch(l+"/user/addresses",{headers:{Authorization:"Bearer "+p,"Content-Type":"application/json"}});if(e.ok){const s=await e.json();if(s.isSuccess||s.success){const e=s.data||[];N(e);const i=e.find(e=>e.isDefault)||e[0];i&&(z(i.id),S(!0),L(i),I.address||I.city||I.district||L(i))}}}catch(e){}finally{w(!1)}},L=e=>{e&&M({address:e.addressLine,city:e.city,district:e.district,addressDetail:e.addressDetail||""})},T=e=>{z(e);const s=v.find(s=>s.id===e);s&&L(s)},F=(e=>{const s=e.replace(/\s/g,"");return s?/^4/.test(s)?"visa":/^5[1-5]/.test(s)||/^2[2-7]/.test(s)?"mastercard":/^3[47]/.test(s)?"amex":/^6(?:011|5|4[4-9])/.test(s)?"discover":/^9792/.test(s)?"troy":null:null})(A.cardNumber);if(0===c.length)return i.jsx("div",{className:"checkout-container",children:i.jsxs("div",{className:"empty-checkout",children:[i.jsx("h2",{children:"Sepetiniz boş"}),i.jsx("p",{children:"Ödeme yapmak için sepetinizde ürün bulunmalıdır."}),i.jsx("button",{onClick:()=>d("/"),className:"shop-btn",children:"Alışverişe Başla"})]})});const Y={"@context":"https://schema.org","@type":"CheckoutPage",name:"Ödeme - Hiedra Perde",description:"Hiedra Perde siparişinizi tamamlayın. Güvenli ödeme sistemi ile alışveriş yapın.",url:window.location.href};return i.jsxs("div",{className:"checkout-container",children:[i.jsx(n,{title:"Ödeme - Perde Satış Ödeme Sayfası",description:"Perde satış ödeme sayfası. Güvenli ödeme sistemi ile siparişinizi tamamlayın. Hiedra Perde ile güvenli alışveriş.",keywords:"perde ödeme, online perde ödeme, perde satış ödeme, güvenli ödeme, perde sipariş ödeme",url:"/checkout",structuredData:Y,noindex:!0}),i.jsxs("header",{className:"checkout-header",children:[i.jsx("h1",{children:"Ödeme"}),i.jsx("div",{className:"checkout-steps",children:[1,2,3,4].map(e=>i.jsxs("div",{className:`step ${e>g?"":"active"} ${g===e?"current":""}`,children:[i.jsx("div",{className:"step-number",children:e}),i.jsxs("div",{className:"step-label",children:[1===e&&"İletişim",2===e&&"Adres",3===e&&"Ödeme",4===e&&"Özet"]})]},e))})]}),i.jsxs("div",{className:"checkout-content",children:[i.jsxs("div",{className:"checkout-form-section",children:[1===g&&i.jsxs("section",{className:"checkout-step",children:[i.jsx("h2",{children:"İletişim Bilgileri"}),u&&h&&i.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",backgroundColor:"#e7f3ff",borderRadius:"4px",border:"1px solid #b3d9ff",fontSize:"0.9rem",color:"#004085"},children:i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Bilgi:"})," İletişim bilgileriniz hesabınızdan otomatik olarak doldurulmuştur. İsterseniz değiştirebilirsiniz."]})}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"firstName",children:["Ad ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"text",id:"firstName",name:"firstName",value:D.firstName,onChange:e=>q({...D,firstName:e.target.value}),placeholder:"Adınız",autoComplete:"given-name",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"lastName",children:["Soyad ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"text",id:"lastName",name:"lastName",value:D.lastName,onChange:e=>q({...D,lastName:e.target.value}),placeholder:"Soyadınız",autoComplete:"family-name",required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["E-posta ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:D.email,onChange:e=>q({...D,email:e.target.value}),placeholder:"ornek@email.com",autoComplete:"email",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"phone",children:["Telefon ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"tel",id:"phone",name:"phone",value:D.phone,onChange:e=>{const s=e.target.value.replace(/\D/g,"");s.length>11||q({...D,phone:s})},placeholder:"05XX XXX XX XX",autoComplete:"tel",required:!0})]})]}),2===g&&i.jsxs("section",{className:"checkout-step",children:[i.jsx("h2",{children:"Adres Bilgileri"}),!u&&i.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",backgroundColor:"#f8f9fa",borderRadius:"4px",border:"1px solid #dee2e6"},children:i.jsx("p",{style:{margin:0,color:"#495057"},children:"Lütfen teslimat adresinizi giriniz. Tüm alanları doldurmanız gerekmektedir."})}),u&&v.length>0&&i.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",backgroundColor:"#e7f3ff",borderRadius:"4px",border:"1px solid #b3d9ff",fontSize:"0.9rem",color:"#004085"},children:i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Bilgi:"})," Varsayılan adresiniz otomatik olarak seçilmiştir. Kayıtlı adreslerinizden birini seçebilir veya yeni adres girebilirsiniz."]})}),u&&v.length>0&&i.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:k,onChange:e=>{if(S(e.target.checked),e.target.checked&&b){const e=v.find(e=>e.id===b);e&&L(e)}else e.target.checked||M({address:"",city:"",district:"",addressDetail:""})},style:{marginRight:"0.5rem"}}),"Kayıtlı adreslerimden seç"]}),k&&i.jsx("div",{style:{marginTop:"1rem",padding:"1rem",border:"1px solid #ddd",borderRadius:"4px"},children:C?i.jsx("p",{children:"Adresler yükleniyor..."}):i.jsx("div",{children:v.map(e=>i.jsx("div",{style:{padding:"0.75rem",marginBottom:"0.5rem",border:b===e.id?"2px solid #007bff":"1px solid #ddd",borderRadius:"4px",cursor:"pointer",backgroundColor:b===e.id?"#f0f8ff":"#fff"},onClick:()=>T(e.id),children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{fontWeight:"bold",marginBottom:"0.25rem"},children:[e.fullName,e.isDefault&&i.jsx("span",{style:{marginLeft:"0.5rem",fontSize:"0.85rem",color:"#28a745"},children:"(Varsayılan)"})]}),i.jsxs("div",{style:{fontSize:"0.9rem",color:"#666"},children:[e.addressLine,e.addressDetail&&", "+e.addressDetail]}),i.jsxs("div",{style:{fontSize:"0.9rem",color:"#666"},children:[e.district,", ",e.city]}),i.jsx("div",{style:{fontSize:"0.9rem",color:"#666"},children:e.phone})]}),i.jsx("input",{type:"radio",name:"selectedAddress",checked:b===e.id,onChange:()=>T(e.id),style:{marginLeft:"1rem"}})]})},e.id))})})]}),(!u||!k)&&i.jsxs(i.Fragment,{children:[u&&!k&&i.jsx("div",{style:{padding:"0.75rem",marginBottom:"1rem",backgroundColor:"#fff3cd",borderRadius:"4px",border:"1px solid #ffc107",fontSize:"0.9rem",color:"#856404"},children:"Yeni adres bilgilerinizi giriniz."}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"address",children:["Adres ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"text",id:"address",name:"address",value:I.address,onChange:e=>M({...I,address:e.target.value}),placeholder:"Mahalle, Sokak, Cadde",autoComplete:"street-address",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"addressDetail",children:"Adres Detayı (Opsiyonel)"}),i.jsx("textarea",{id:"addressDetail",value:I.addressDetail,onChange:e=>M({...I,addressDetail:e.target.value}),placeholder:"Daire no, kat, bina adı vb.",rows:"3"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"city",children:["Şehir ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"text",id:"city",name:"city",value:I.city,onChange:e=>M({...I,city:e.target.value}),required:!0,placeholder:"Şehir adı"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"district",children:["İlçe ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"text",id:"district",name:"district",value:I.district,onChange:e=>M({...I,district:e.target.value}),required:!0,placeholder:"İlçe adı"})]})]})]})]}),3===g&&i.jsxs("section",{className:"checkout-step",children:[i.jsx("h2",{children:"Ödeme Bilgileri"}),i.jsx("p",{className:"step-description",children:"Güvenli ödeme için kart bilgilerinizi giriniz"}),i.jsx("div",{className:"supported-cards",children:i.jsxs("div",{className:"card-icons",children:[i.jsx("span",{className:"card-icon "+("visa"===F?"active":""),title:"Visa",children:i.jsx("img",{src:"/images/visa.png",alt:"Visa",className:"card-logo-img"})}),i.jsx("span",{className:"card-icon "+("mastercard"===F?"active":""),title:"Mastercard",children:i.jsx("img",{src:"/images/master.png",alt:"Mastercard",className:"card-logo-img"})}),i.jsx("span",{className:"card-icon "+("troy"===F?"active":""),title:"Troy",children:i.jsx("img",{src:"/images/troy.png",alt:"Troy",className:"card-logo-img"})})]})}),i.jsxs("form",{autoComplete:"on",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"cardNumber",children:["Kart Numarası ",i.jsx("span",{className:"required",children:"*"})]}),i.jsxs("div",{className:"card-input-wrapper",children:[i.jsx("input",{type:"tel",id:"cardNumber",name:"cardNumber",value:A.cardNumber,onChange:e=>{const s=(e=>{const s=e.replace(/\s/g,"");return(s.match(/.{1,4}/g)?.join(" ")||s).slice(0,19)})(e.target.value);P({...A,cardNumber:s})},placeholder:"1234 5678 9012 3456",maxLength:"19",autoComplete:"cc-number",inputMode:"numeric",pattern:"[0-9\\s]{13,19}",required:!0}),F&&i.jsxs("div",{className:"detected-card-icon",children:["visa"===F&&i.jsx("img",{src:"/images/visa.png",alt:"Visa",className:"detected-card-logo"}),"mastercard"===F&&i.jsx("img",{src:"/images/master.png",alt:"Mastercard",className:"detected-card-logo"}),"troy"===F&&i.jsx("img",{src:"/images/troy.png",alt:"Troy",className:"detected-card-logo"})]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"cardName",children:["Kart Üzerindeki İsim ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"text",id:"cardName",name:"cardName",value:A.cardName,onChange:e=>P({...A,cardName:e.target.value.toUpperCase()}),placeholder:"AD SOYAD",autoComplete:"cc-name",required:!0})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"expiryMonth",children:["Son Kullanma Tarihi ",i.jsx("span",{className:"required",children:"*"})]}),i.jsxs("div",{className:"expiry-inputs",children:[i.jsxs("select",{id:"expiryMonth",name:"expiryMonth",value:A.expiryMonth,onChange:e=>P({...A,expiryMonth:e.target.value}),autoComplete:"cc-exp-month",required:!0,children:[i.jsx("option",{value:"",children:"Ay"}),Array.from({length:12},(e,s)=>s+1).map(e=>i.jsx("option",{value:(e+"").padStart(2,"0"),children:(e+"").padStart(2,"0")},e))]}),i.jsxs("select",{id:"expiryYear",name:"expiryYear",value:A.expiryYear,onChange:e=>P({...A,expiryYear:e.target.value}),autoComplete:"cc-exp-year",required:!0,children:[i.jsx("option",{value:"",children:"Yıl"}),Array.from({length:10},(e,s)=>(new Date).getFullYear()+s).map(e=>i.jsx("option",{value:(e+"").slice(-2),children:e},e))]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"cvv",children:["CVV ",i.jsx("span",{className:"required",children:"*"})]}),i.jsx("input",{type:"tel",id:"cvv",name:"cvv",value:A.cvv,onChange:e=>{const s=e.target.value.replace(/\D/g,"");s.length>3||P({...A,cvv:s})},placeholder:"123",maxLength:"3",autoComplete:"cc-csc",inputMode:"numeric",pattern:"[0-9]{3}",required:!0})]})]})]})]}),4===g&&i.jsxs("section",{className:"checkout-step",children:[i.jsx("h2",{children:"Sipariş Özeti"}),i.jsx("p",{className:"step-description",children:"Lütfen bilgilerinizi kontrol ediniz"}),i.jsxs("div",{className:"summary-section",children:[i.jsxs("div",{className:"summary-info-card",children:[i.jsxs("div",{className:"card-header-with-edit",children:[i.jsx("h3",{children:"İletişim Bilgileri"}),i.jsx("button",{type:"button",className:"edit-info-btn-card",onClick:()=>{j(1)},"aria-label":"İletişim bilgilerini düzenle",children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),i.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})]}),i.jsxs("div",{className:"info-details",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Ad Soyad:"})," ",D.firstName," ",D.lastName]}),i.jsxs("p",{children:[i.jsx("strong",{children:"E-posta:"})," ",D.email]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Telefon:"})," ",D.phone]})]})]}),i.jsxs("div",{className:"summary-info-card",children:[i.jsxs("div",{className:"card-header-with-edit",children:[i.jsx("h3",{children:"Adres Bilgileri"}),i.jsx("button",{type:"button",className:"edit-info-btn-card",onClick:()=>{j(2)},"aria-label":"Adres bilgilerini düzenle",children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),i.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})]}),i.jsxs("div",{className:"info-details",children:[i.jsx("p",{children:I.address}),i.jsxs("p",{children:[I.district,", ",I.city]}),I.addressDetail&&i.jsxs("p",{children:[i.jsx("strong",{children:"Adres Detayı:"})," ",I.addressDetail]})]})]}),i.jsxs("div",{className:"summary-info-card",children:[i.jsxs("div",{className:"card-header-with-edit",children:[i.jsx("h3",{children:"Ödeme Bilgileri"}),i.jsx("button",{type:"button",className:"edit-info-btn-card",onClick:()=>{j(3)},"aria-label":"Ödeme bilgilerini düzenle",children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),i.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})]}),i.jsxs("div",{className:"info-details",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Kart Numarası:"})," •••• •••• •••• ",4>A.cardNumber.length?"":A.cardNumber.slice(-4)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Kart Sahibi:"})," ",A.cardName]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Son Kullanma:"})," ",A.expiryMonth,"/",A.expiryYear]})]})]}),i.jsxs("div",{className:"summary-info-card",children:[i.jsx("h3",{children:"Sipariş Detayları"}),i.jsx("div",{className:"order-items-summary",children:c.map(e=>i.jsxs("div",{className:"order-item",children:[i.jsxs("div",{className:"order-item-info",children:[i.jsx("span",{className:"order-item-name",children:e.name}),e.customizations&&i.jsxs("div",{className:"order-item-details",children:[i.jsxs("span",{children:["En: ",e.customizations.en," cm"]}),i.jsxs("span",{children:["Boy: ",e.customizations.boy," cm"]}),i.jsxs("span",{children:["Pile: ","pilesiz"===e.customizations.pileSikligi?"Pilesiz":e.customizations.pileSikligi]})]}),i.jsxs("span",{className:"order-item-quantity",children:["Adet: ",e.quantity]})]}),i.jsxs("div",{className:"order-item-price",children:[((e.customizations?.calculatedPrice||e.price)*e.quantity).toFixed(2)," ₺"]})]},e.itemKey||e.id))}),i.jsxs("div",{className:"order-total-summary",children:[i.jsxs("div",{className:"total-row",children:[i.jsx("span",{children:"Ara Toplam:"}),i.jsxs("span",{children:[o().toFixed(2)," ₺"]})]}),i.jsxs("div",{className:"total-row",children:[i.jsx("span",{children:"Kargo:"}),i.jsx("span",{className:"free-shipping",children:"Ücretsiz"})]}),i.jsxs("div",{className:"total-row final",children:[i.jsx("span",{children:"Toplam:"}),i.jsxs("span",{children:[o().toFixed(2)," ₺"]})]})]})]})]})]}),i.jsxs("div",{className:"checkout-actions",children:[g>1&&i.jsx("button",{type:"button",onClick:()=>{g>1&&j(g-1)},className:"btn-back",children:"← Geri"}),4>g?i.jsx("button",{type:"button",onClick:()=>{1===g?(D.firstName.trim()?D.lastName.trim()?D.email.trim()&&D.email.includes("@")?D.phone.trim()&&D.phone.length>=10||(x.warning("Lütfen geçerli bir telefon numarası giriniz."),0):(x.warning("Lütfen geçerli bir e-posta adresi giriniz."),0):(x.warning("Lütfen soyadınızı giriniz."),0):(x.warning("Lütfen adınızı giriniz."),0))&&j(2):2===g?(I.address.trim()?I.city.trim()?I.district.trim()||(x.warning("Lütfen ilçe bilgisini giriniz."),0):(x.warning("Lütfen şehir bilgisini giriniz."),0):(x.warning("Lütfen adres bilgilerinizi giriniz."),0))&&j(3):3===g&&(()=>{const e=A.cardNumber.replace(/\s/g,"");return e&&16===e.length&&/^\d+$/.test(e)?A.cardName.trim()?A.expiryMonth&&A.expiryYear?!(!A.cvv||3!==A.cvv.length||!/^\d+$/.test(A.cvv))||(x.warning("Lütfen geçerli bir CVV giriniz (3 haneli)."),!1):(x.warning("Lütfen kart son kullanma tarihini seçiniz."),!1):(x.warning("Lütfen kart üzerindeki ismi giriniz."),!1):(x.warning("Lütfen geçerli bir kart numarası giriniz (16 haneli)."),!1)})()&&j(4)},className:"btn-next",children:3===g?"Özet'e Git →":"İlerle →"}):4===g?i.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),(async e=>{if(e&&(e.preventDefault(),e.stopPropagation()),!y){f(!0);try{const e=await(async()=>{try{const s=A.cardNumber.replace(/\s/g,""),i=`${A.expiryMonth}/${A.expiryYear}`,a=c.map(e=>{const s=(e.customizations?.calculatedPrice||e.price)*e.quantity,i=e.customizations?.en||100,a=e.customizations?.boy||200;return{productId:e.id,productName:e.name,width:i,height:a,pleatType:"pilesiz"===e.customizations?.pileSikligi?"1x1":e.customizations?.pileSikligi||"1x1",quantity:e.quantity,price:s}}),r={amount:0,cardNumber:s,cardExpiry:i,cardCvc:A.cvv,firstName:D.firstName,lastName:D.lastName,email:D.email,phone:D.phone.replace(/\D/g,""),address:I.address,city:I.city,district:I.district,addressDetail:I.addressDetail||null,orderDetails:a,frontendCallbackUrl:window.location.origin+"/payment/3d-callback",addressId:u&&k&&b?b:null,userId:u&&h?.id?h.id:null},t=await fetch(l+"/payment/card",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),n=(t.headers.get("content-type"),await t.text());let d;try{if(!n||""===n.trim())return{success:!1,message:"Sunucudan yanıt alınamadı."};d=JSON.parse(n)}catch(e){return n.trim().startsWith("<!DOCTYPE")||n.trim().startsWith("<html")?(sessionStorage.setItem("checkoutData",JSON.stringify({contactInfo:D,addressInfo:I,cardInfo:A,items:c,totalPrice:o()})),sessionStorage.setItem("frontendUrl",window.location.origin),document.open(),document.write(n),document.close(),{success:!1,message:"3D Secure yönlendirmesi yapılıyor...",redirecting:!0}):{success:!1,message:"Sunucu yanıtı işlenemedi: "+e.message}}if(t.ok){const e=!0===d.isSuccess||!0===d.success;if(e&&d.data&&"string"==typeof d.data&&(d.data.trim().startsWith("<!DOCTYPE")||d.data.trim().startsWith("<html")||d.data.includes("<form"))){sessionStorage.setItem("checkoutData",JSON.stringify({contactInfo:D,addressInfo:I,cardInfo:A,items:c,totalPrice:o()})),sessionStorage.setItem("frontendUrl",window.location.origin);const e=d.data;return document.open(),document.write(e),document.close(),{success:!1,message:"3D Secure yönlendirmesi yapılıyor...",redirecting:!0}}return!0===d.requires3D&&d.redirectUrl?(sessionStorage.setItem("checkoutData",JSON.stringify({contactInfo:D,addressInfo:I,cardInfo:A,items:c,totalPrice:o()})),sessionStorage.setItem("frontendUrl",window.location.origin),window.location.href=d.redirectUrl,{success:!1,message:"3D Secure yönlendirmesi yapılıyor...",redirecting:!0}):{success:e,message:d.message||(e?"Ödeme başarıyla tamamlandı":"Ödeme işlemi başarısız oldu")}}return{success:!1,message:d.message||`Hata: ${t.status} ${t.statusText}`}}catch(s){return{success:!1,message:s.message||"Ödeme işlemi sırasında bir hata oluştu."}}})();if(e.redirecting)return;if(e.success){const e={orderNumber:"ORD-"+Math.random().toString(36).substring(2,10).toUpperCase(),contactInfo:D,addressInfo:I,cardInfo:A,items:c,totalPrice:o()};m(),sessionStorage.removeItem("checkoutData"),d("/siparis-onayi",{state:{orderData:e}})}else f(!1),d("/odeme-basarisiz",{state:{errorMessage:e.message}})}catch(s){f(!1),d("/odeme-basarisiz")}}})(e)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},className:"btn-complete",disabled:y,children:y?"Ödeme İşleniyor...":"Ödeme Yap"}):null]})]}),i.jsxs("aside",{className:"checkout-summary",children:[i.jsx("h2",{children:"Sipariş Özeti"}),g>=1&&D.firstName&&i.jsxs("div",{className:"summary-info-section",children:[i.jsx("h3",{children:"İletişim"}),i.jsxs("div",{className:"summary-info-content",children:[i.jsxs("p",{children:[D.firstName," ",D.lastName]}),i.jsx("p",{children:D.email}),i.jsx("p",{children:D.phone})]})]}),g>=2&&I.address&&i.jsxs("div",{className:"summary-info-section",children:[i.jsx("h3",{children:"Adres"}),i.jsxs("div",{className:"summary-info-content",children:[i.jsx("p",{children:I.address}),i.jsxs("p",{children:[I.district,", ",I.city]})]})]}),g>=3&&A.cardNumber&&i.jsxs("div",{className:"summary-info-section",children:[i.jsx("h3",{children:"Ödeme"}),i.jsxs("div",{className:"summary-info-content",children:[i.jsxs("p",{children:["•••• •••• •••• ",4>A.cardNumber.length?"":A.cardNumber.slice(-4)]}),i.jsx("p",{children:A.cardName}),i.jsxs("p",{children:[A.expiryMonth,"/",A.expiryYear]})]})]}),i.jsx("div",{className:"summary-items",children:c.map(e=>i.jsxs("div",{className:"summary-item",children:[i.jsxs("div",{className:"summary-item-info",children:[i.jsx("span",{className:"item-name",children:e.name}),e.customizations&&i.jsxs("div",{className:"item-details",children:[i.jsxs("span",{children:["En: ",e.customizations.en," cm"]}),i.jsxs("span",{children:["Boy: ",e.customizations.boy," cm"]}),i.jsxs("span",{children:["Pile: ","pilesiz"===e.customizations.pileSikligi?"Pilesiz":e.customizations.pileSikligi]})]})]}),i.jsxs("div",{className:"summary-item-price",children:[((e.customizations?.calculatedPrice||e.price)*e.quantity).toFixed(2)," ₺"]})]},e.itemKey||e.id))}),i.jsxs("div",{className:"summary-total",children:[i.jsxs("div",{className:"total-row",children:[i.jsx("span",{children:"Ara Toplam:"}),i.jsxs("span",{children:[o().toFixed(2)," ₺"]})]}),i.jsxs("div",{className:"total-row",children:[i.jsx("span",{children:"Kargo:"}),i.jsx("span",{className:"free-shipping",children:"Ücretsiz"})]}),i.jsxs("div",{className:"total-row final",children:[i.jsx("span",{children:"Toplam:"}),i.jsxs("span",{children:[o().toFixed(2)," ₺"]})]})]})]})]})]})};export{d as default};
